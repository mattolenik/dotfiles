#!/bin/sh
DOTDIR="$PWD/.."
TMUX_PLUGIN_DIR="$HOME/.tmux/plugins"

install_vim_plug() {
  plug="$HOME/.local/share/nvim/site/autoload/plug.vim"
  if [ ! -e "$plug" ]; then
    curl -fLo "$plug" --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  fi
}

install_tpm() {
  tpm="$TMUX_PLUGIN_DIR/tpm"
  if [ ! -e "$tpm" ]; then
    git clone https://github.com/tmux-plugins/tpm "$tpm"
  fi
}

install_tmux_powerline() {
  tmux_powerline="$TMUX_PLUGIN_DIR/tmux-powerline"
  if [ ! -e "$tmux_powerline" ]; then
    git clone https://github.com/erikw/tmux-powerline "$tmux_powerline"
  fi
}

restore_scansnap_plist() {
  plist="Library/Preferences/com.fujitsu.pfu.ScanSnapHomeSetting.plist"
  rsync -u "$DOTDIR/$plist" "$HOME/$plist"
}

setup_all() {
  install_vim_plug
  install_tpm
  install_tmux_powerline
}

setup_macos() {
  restore_scansnap_plist
}

setup_all
if [ "$(uname)" = "Darwin" ]; then
  setup_macos
fi

